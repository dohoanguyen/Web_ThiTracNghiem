@{
    ViewBag.Title = "Liên hệ - TUQ Education";
    Layout = "~/Views/Shared/LayoutPage.cshtml";
}

<section class="py-12 md:py-12 text-center">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-3xl">
        <h1 class="text-4xl md:text-5xl font-extrabold mb-4 text-primary">
            Liên hệ với chúng tôi
        </h1>
        <p class="text-lg text-text-muted-light dark:text-text-muted-dark">
            Chúng tôi luôn sẵn lòng lắng nghe bạn. Vui lòng điền thông tin dưới đây, đội ngũ tư vấn của chúng tôi sẽ liên hệ sớm nhất có thể.
        </p>
    </div>
</section>


<section class="py-12 md:py-16">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-surface-light dark:bg-surface-dark p-8 md:p-10 rounded-2xl shadow-lg grid grid-cols-1 lg:grid-cols-[1fr_auto_1fr] gap-10">

            <!-- Thông tin liên hệ -->
            <div class="flex flex-col">
                <div class="space-y-6 mb-8">
                    <p class="text-text-muted-light dark:text-text-muted-dark">
                        TUQ Education đã đồng hành cùng hàng nghìn học viên trong việc luyện thi trắc nghiệm, nâng cao điểm số và đạt kết quả cao trong kỳ thi THPT Quốc gia.
                    </p>
                    <h2 class="text-3xl font-bold text-primary dark:text-white">
                        Hãy để chúng tôi hỗ trợ bạn luyện thi hiệu quả
                    </h2>
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <div class="mr-6">
                                <p class="font-semibold text-text-light dark:text-text-dark">Số điện thoại</p>
                                <p class="text-text-muted-light dark:text-text-muted-dark">(028) 3812 3456</p>
                            </div>
                            <div>
                                <p class="font-semibold text-text-light dark:text-text-dark">Email</p>
                                <p class="text-text-muted-light dark:text-text-muted-dark">info@tuqeducation.edu.vn</p>
                            </div>
                        </div>
                        <div>
                            <p class="font-semibold text-text-light dark:text-text-dark">Văn phòng</p>
                            <p class="text-text-muted-light dark:text-text-muted-dark">140 Lê Trọng Tấn, Phường Tây Thạnh, Quận Tân Phú, TP. HCM</p>
                        </div>
                    </div>
                    <div>
                        <p class="font-semibold text-text-light dark:text-text-dark mb-2">Nghe cộng đồng nói về chúng tôi</p>
                        <div class="flex space-x-3">
                            <a class="w-10 h-10 bg-blue-600 text-white rounded-lg flex items-center justify-center hover:opacity-90 transition-opacity" href="#">
                                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.323-1.325z"></path></svg>
                            </a>
                            <a class="w-10 h-10 bg-black text-white rounded-lg flex items-center justify-center hover:opacity-90 transition-opacity" href="#">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 448 512"><path d="M448,209.91a210.06,210.06,0,0,1-122.77-39.25V349.38A162.55,162.55,0,1,1,185,188.31V278.2a74.62,74.62,0,1,0,52.23,71.18V0l88,0a121.18,121.18,0,0,0,1.86,22.17h0A122.18,122.18,0,0,0,381,102.39a121.43,121.43,0,0,0,67,20.14Z"></path></svg>
                            </a>
                            <a class="w-10 h-10 bg-red-600 text-white rounded-lg flex items-center justify-center hover:opacity-90 transition-opacity" href="#">
                                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="mt-auto relative w-full h-64 md:h-80 rounded-2xl overflow-hidden">
                    <img class="w-full h-full object-cover"
                         src="https://lh3.googleusercontent.com/aida-public/AB6AXuA1F6pT7MTnNjktE1ylbKcvl4qtzPn-iNLsq1dSI_KCrgCON5ph5taZwDnG-nBCOaJvJbDlTEYR9U2Ew2hrKz2gqQFlFyPpCPk8uBiF5jrSlyex25bWuUjCsvLrIJheKx6_-qXeSJvexWfbzfprysiuuOjVDSXUTHAA2Q719mv0FkUwQSvWFeLQy7Qy_B6r13sRDBVwFCsv0oBdj1BbEc6nLk4JN-JxtNFOUSzA6jKQvGZDOCol-OxMSjKD35gHaMpWw_oUpLcLWlY"
                         alt="Nhân viên hỗ trợ" />
                    <div class="absolute inset-0 bg-gradient-to-t from-primary/60 to-transparent"></div>
                </div>
            </div>

            <div class="hidden lg:block w-px bg-gray-200 dark:bg-gray-700"></div>

            <!-- Form liên hệ -->
            <form id="contactForm" class="space-y-4" method="POST">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="student-name">Họ và tên</label>
                        <input class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary placeholder:text-text-muted-light/70" id="student-name" name="student-name" placeholder="Nhập tên của bạn" type="text" />
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="gender">Giới tính</label>
                        <select class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary" id="gender" name="gender">
                            <option>Nam</option>
                            <option>Nữ</option>
                            <option>Khác</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="dob">Ngày sinh</label>
                    <input class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary placeholder:text-text-muted-light/70" id="dob" name="dob" type="date" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="email">Email</label>
                    <input class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary placeholder:text-text-muted-light/70" id="email" name="email" placeholder="email@example.com" type="email" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="phone">Số điện thoại</label>
                    <input class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary placeholder:text-text-muted-light/70" id="phone" name="phone" placeholder="0123 456 789" type="tel" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="address">Địa chỉ</label>
                    <input class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary placeholder:text-text-muted-light/70" id="address" name="address" placeholder="Nhập địa chỉ của bạn" type="text" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-text-muted-light dark:text-text-muted-dark mb-1.5" for="cccd">CCCD</label>
                    <input class="block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary placeholder:text-text-muted-light/70" id="cccd" name="cccd" placeholder="Nhập số CCCD của bạn" type="text" />
                </div>
                <div class="pt-2">
                    <button class="w-full bg-primary text-white py-3 px-6 rounded-lg font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2 text-base" type="submit">
                        Gửi liên hệ
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Google Maps -->
<section class="pb-12 md:pb-16">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="rounded-2xl overflow-hidden shadow-xl">
            <iframe src="https://www.google.com/maps?q=140+L%C3%AA+Tr%E1%BB%9Bng+T%E1%BA%A5n,+T%C3%A2n+Ph%C3%BA,+TP.+HCM&output=embed"
                    width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
    </div>
</section>

<!-- Thông báo -->
<div id="toast" class="fixed top-16 right-5 z-50 opacity-0 transition-opacity duration-500 flex items-center gap-3 px-6 py-3 rounded-lg shadow-lg"></div>

<script>
    const form = document.getElementById('contactForm');
    const toast = document.getElementById('toast');

    function showToast(message, type = 'success') {
        let bgColor = 'bg-green-600';
        let iconSVG = `
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg>
    `;
        if (type === 'error') {
            bgColor = 'bg-red-600';
            iconSVG = `
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
        `;
        }

        toast.innerHTML = `<div class="flex items-center gap-3">${iconSVG}<span>${message}</span></div>`;
        toast.className = `fixed top-16 right-5 z-50 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg opacity-100 transition-opacity duration-500 flex items-center gap-3`;

        setTimeout(() => {
            toast.className = `fixed top-16 right-5 z-50 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-500 flex items-center gap-3`;
        }, 3000);
    }

    form.addEventListener('submit', function (e) {
        e.preventDefault();

        const name = document.getElementById('student-name').value.trim();
        const gender = document.getElementById('gender').value;
        const dobInput = document.getElementById('dob').value;
        const email = document.getElementById('email').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const address = document.getElementById('address').value.trim();
        const cccd = document.getElementById('cccd').value.trim();

        // Kiểm tra họ tên (chỉ chữ + dấu)
        if (!name) { showToast('Vui lòng nhập họ và tên!', 'error'); return; }

        // Kiểm tra ngày sinh và tuổi
        if (!dobInput) { showToast('Vui lòng chọn ngày sinh!', 'error'); return; }
        const dob = new Date(dobInput);
        const today = new Date();
        let age = today.getFullYear() - dob.getFullYear();
        const monthDiff = today.getMonth() - dob.getMonth();
        const dayDiff = today.getDate() - dob.getDate();
        if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) age--;
        if (age < 15) { showToast('Bạn phải từ 15 tuổi trở lên!', 'error'); return; }

        // Kiểm tra email
        if (!email) { showToast('Vui lòng nhập email!', 'error'); return; }

        // Kiểm tra số điện thoại (10 số)
        const phonePattern = /^\d{10}$/;
        if (!phonePattern.test(phone)) { showToast('Số điện thoại phải gồm 10 chữ số!', 'error'); return; }

        // Kiểm tra CCCD (12 số)
        const cccdPattern = /^\d{12}$/;
        if (!cccdPattern.test(cccd)) { showToast('CCCD phải gồm 12 chữ số!', 'error'); return; }

        // Chuẩn bị dữ liệu gửi lên Google Form
        const data = new URLSearchParams();
        data.append('entry.1168924034', name);
        data.append('entry.693795292', gender);
        data.append('entry.642923941_year', dob.getFullYear());
        data.append('entry.642923941_month', dob.getMonth() + 1);
        data.append('entry.642923941_day', dob.getDate());
        data.append('entry.1757158648', email);
        data.append('entry.1802091908', phone);
        data.append('entry.1214556961', address);
        data.append('entry.1458113490', cccd);

        fetch('https://docs.google.com/forms/d/e/1FAIpQLSeR4RgvS9FiqmNvwI6WeoeAw6RhDH9CEwgBvrgYXT1MvrIncw/formResponse', {
            method: 'POST',
            body: data,
            mode: 'no-cors'
        }).then(() => {
            form.reset();
            showToast('Gửi thông tin thành công!', 'success');
        }).catch(() => {
            showToast('Có lỗi xảy ra. Vui lòng thử lại!', 'error');
        });
    });
</script>
