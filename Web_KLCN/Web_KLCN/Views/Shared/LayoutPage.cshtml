@{
    var maTK = Session["MaTK"];
    var hv = Session["HOCVIEN"] as Web_KLCN.Models.HOCVIEN;
    var tenHV = hv != null ? hv.TenHV : "Học viên";
    var tenDangNhap = Session["TenDangNhap"];
    var avatar = hv?.AnhDaiDien != null ? Url.Content("~/hinhanh/" + hv.AnhDaiDien) : Url.Content("~/hinhanh/user.png");
}
<!DOCTYPE html>
<html class="scroll-smooth" lang="vi">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>TUQ Education - Trung tâm Luyện thi THPT</title>
    <link rel="icon" type="image/png" href="~/hinhanh/logo.png" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/vn.js"></script>

    <style>
        /* Các CSS tùy chỉnh của bạn */
        body {
            font-family: 'Lexend', sans-serif;
        }

        .font-display {
            font-family: 'Lexend', sans-serif;
        }

        keyframes scroll-left {
            from

        {
            transform: translateX(0);
        }

        to {
            transform: translateX(-50%);
        }

        }

        keyframes scroll-right {
            from

        {
            transform: translateX(-50%);
        }

        to {
            transform: translateX(0);
        }

        }

        .animate-scroll-left {
            animation: scroll-left 40s linear infinite;
        }

        .animate-scroll-right {
            animation: scroll-right 40s linear infinite;
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#1800AC",
                        "background-light": "#F7F8FD",
                        "background-dark": "#101828",
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#1D2939",
                        "text-light": "#1D2939",
                        "text-dark": "#F5F5F5",
                        "text-muted-light": "#667085",
                        "text-muted-dark": "#98A2B3",
                    },
                    fontFamily: {
                        display: ["Lexend", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "12px",
                    },
                },
            },
        };
    </script>
</head>

<body class="bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark font-display antialiased">
    <div class="relative overflow-hidden">

        <header class="fixed top-0 left-0 right-0 z-50 bg-white/80 dark:bg-background-dark/80 backdrop-blur-sm border-b border-gray-200/80 dark:border-gray-800/80">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-20">
                    <a class="flex items-center gap-2" href="/">
                        <img src="~/hinhanh/logo.png" alt="TUQ Education Logo" class="h-10 w-auto" />
                        <div>
                            <span class="text-xl font-bold text-primary leading-none">TUQ Education</span>
                            <p class="text-xs text-text-muted-light dark:text-text-muted-dark leading-none">Trung tâm luyện thi THPT</p>
                        </div>
                    </a>

                    <div class="hidden md:flex items-center gap-6">
                        @if (maTK != null)
                        {
                            <nav id="mainNav" class="flex items-center space-x-6">
                                <a href="@Url.Action("Index", "HocVien")" class="nav-link transition-colors">Trang chủ</a>
                                <a href="@Url.Action("LichHoc", "HocVien")" class="nav-link transition-colors">Lịch học</a>
                                <a href="@Url.Action("KhoaHoc", "HocVien")" class="nav-link transition-colors">Khóa học</a>
                                <a href="@Url.Action("LichThi", "HocVien")" class="nav-link transition-colors">Lịch thi</a>
                                <a href="@Url.Action("DiemThi", "HocVien")" class="nav-link transition-colors">Kết quả</a>
                            </nav>

                            <div class="relative ms-4">
                                <button id="userMenuButton" aria-expanded="false" class="flex items-center gap-2 focus:outline-none">
                                    <img src="@avatar" alt="avatar" class="w-8 h-8 rounded-full border-2 border-primary" />
                                    <span class="font-semi text-primary dark:text-white">@tenHV</span>
                                </button>

                                <ul id="userDropdownMenu" class="absolute right-0 top-full mt-2 z-50 shadow-xl rounded-xl p-2 bg-surface-light dark:bg-surface-dark min-w-[280px] hidden border border-gray-100 dark:border-gray-700">

                                    <li class="px-3 py-3 mb-2 border-b border-gray-200 dark:border-gray-700">
                                        <div class="flex items-center gap-3">
                                            <img src="@avatar" alt="avatar" class="w-12 h-12 rounded-full border-2 border-primary" />
                                            <div>
                                                <div>
                                                    <div class="font-semi text-lg text-primary dark:text-white">@tenHV</div> <div class="text-sm text-gray-500 dark:text-gray-400 font-medium">@tenDangNhap</div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <li>
                                        <a class="flex items-center gap-2 py-3 px-3 text-gray-800 dark:text-gray-200 hover:bg-primary/10 rounded-lg transition-colors group"
                                           href="/HocVien/ThongTinCaNhan">
                                            <i class="material-icons text-primary group-hover:text-primary">badge</i>
                                            <span class="font-semi">Thông tin cá nhân</span>
                                        </a>
                                    </li>

                                    <li>
                                        <a class="flex items-center gap-2 py-3 px-3 text-gray-800 dark:text-gray-200 hover:bg-primary/10 rounded-lg transition-colors group"
                                           href="/HocVien/DoiMatKhau">
                                            <i class="material-icons text-primary group-hover:text-primary">vpn_key</i>
                                            <span class="font-semi">Đổi mật khẩu</span>
                                        </a>
                                    </li>

                                    <li><hr class="my-2 border-gray-200 dark:border-gray-700"></li>

                                    <li>
                                        <a class="flex items-center gap-2 py-3 px-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/50 rounded-lg transition-colors font-semi"
                                           href="/Home/Logout">
                                            <i class="material-icons">logout</i>
                                            Đăng xuất
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        }
                        else
                        {
                            <nav id="mainNav" class="flex items-center space-x-6">
                                <a href="@Url.Action("Index", "Home")" class="nav-link transition-colors">Trang chủ</a>
                                <a href="@Url.Action("KhoaHoc", "Home")" class="nav-link transition-colors">Khóa học</a>
                                <a href="@Url.Action("LuyenThiTHPT", "Home")" class="nav-link transition-colors">Luyện thi THPT</a>
                                <a href="@Url.Action("TinTuc", "Home")" class="nav-link transition-colors">Tin tức</a>
                                <a href="@Url.Action("LienHe", "Home")" class="nav-link transition-colors">Liên hệ</a>
                            </nav>
                            <a href="@Url.Action("Login", "Home")" class="bg-primary text-white px-5 py-2.5 rounded-lg font-semibold hover:opacity-90 transition-opacity flex items-center gap-2">
                                <span class="material-symbols-outlined text-base">login</span> Đăng nhập
                            </a>
                        }
                    </div>
                </div>
            </div>
        </header>

        <main class="pt-24">
            @RenderBody()
        </main>

        <footer class="bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-800">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                        <a class="flex items-center gap-2 mb-4" href="#">
                            <img src="~/hinhanh/logo.png" alt="TUQ Education Logo" class="h-10 w-auto" />
                            <div>
                                <span class="text-xl font-bold text-primary leading-none">TUQ Education</span>
                                <p class="text-xs text-text-muted-light dark:text-text-muted-dark leading-none">Trung tâm luyện thi THPT</p>
                            </div>
                        </a>
                        <p class="text-text-muted-light dark:text-text-muted-dark max-w-sm">Nền tảng hàng đầu cho việc luyện thi THPT, chắp cánh ước mơ vào đại học cho thế hệ trẻ Việt Nam.</p>
                        <div class="flex space-x-4 mt-6">
                            <a class="text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-white" href="#"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.323-1.325z"></path></svg></a>
                            <a class="text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-white" href="#"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.979v16h4.979v-8.399c0-2.022 1.825-3.651 4.012-3.651 2.22 0 4.012 1.629 4.012 3.651v8.399h4.988v-10.131c0-5.598-4.185-10.131-9.289-10.131-5.104 0-9.289 4.533-9.289 10.131v1.666z"></path></svg></a>
                            <a class="text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-white" href="#"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">Khóa học</h3>
                        <ul class="space-y-3 text-text-muted-light dark:text-text-muted-dark">
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Luyện thi THPT Quốc gia</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Luyện thi Đánh giá năng lực</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Luyện đề chuyên sâu</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Lớp học trực tuyến</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">Về TUQ Education</h3>
                        <ul class="space-y-3 text-text-muted-light dark:text-text-muted-dark">
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Giới thiệu</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Đội ngũ giáo viên</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Tin tức &amp; Sự kiện</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Liên hệ</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">Hỗ trợ</h3>
                        <ul class="space-y-3 text-text-muted-light dark:text-text-muted-dark">
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Câu hỏi thường gặp</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Điều khoản dịch vụ</a></li>
                            <li><a class="hover:text-primary dark:hover:text-white" href="#">Chính sách bảo mật</a></li>
                        </ul>
                    </div>
                </div>
                <div class="mt-16 border-t border-gray-200 dark:border-gray-800 pt-8 text-center text-text-muted-light dark:text-text-muted-dark">
                    <p>© 2025 TUQ Education. All Rights Reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    @if (maTK != null)
    {
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const button = document.getElementById('userMenuButton');
                // Lấy thẻ <ul> menu dropdown
                const menu = document.querySelector('#userMenuButton').nextElementSibling;

                if (button && menu) {
                    button.addEventListener('click', function () {
                        // Bật/tắt class 'hidden' để ẩn/hiện menu
                        menu.classList.toggle('hidden');
                    });

                    // Ẩn dropdown khi click ra ngoài (ngoại trừ nút bấm và menu)
                    document.addEventListener('click', function (event) {
                        if (!button.contains(event.target) && !menu.contains(event.target)) {
                            if (!menu.classList.contains('hidden')) {
                                menu.classList.add('hidden');
                            }
                        }
                    });

                    // Ngăn sự kiện click trong menu lan ra ngoài (để menu không đóng ngay)
                    menu.addEventListener('click', function (event) {
                        event.stopPropagation();
                    });
                }
            });
        </script>
    }

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const nav = document.getElementById('mainNav');
            if (!nav) return;

            const links = nav.querySelectorAll('a.nav-link');
            // Lấy URL Path hiện tại và chuẩn hóa (lowercase, loại bỏ / ở cuối)
            const currentPath = window.location.pathname.toLowerCase().replace(/\/$/, '');

            links.forEach(link => {
                const linkPath = link.getAttribute('href').toLowerCase().replace(/\/$/, '');

                // 1. Reset về trạng thái mặc định (quan trọng!)
                link.classList.remove('font-bold', 'text-primary', 'dark:text-white');
                link.classList.add('text-text-muted-light', 'dark:text-text-muted-dark', 'hover:text-primary', 'dark:hover:text-white', 'font-medium');

                // 2. Kiểm tra và áp dụng style active
                if (currentPath === linkPath) {
                    // Link khớp hoàn toàn, đây là trang active: tô đậm và dùng màu primary/white
                    link.classList.add('text-primary', 'dark:text-white', 'font-bold');
                    // Xóa các class mặc định để tránh xung đột
                    link.classList.remove('text-text-muted-light', 'dark:text-text-muted-dark', 'font-medium');
                }
            });
        });
    </script>
</body>
</html>